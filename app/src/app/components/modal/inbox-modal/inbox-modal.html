<div class="fixed right-6 top-14 z-50 w-[26rem] max-w-[calc(100vw-3rem)]">
  <div
    class="overflow-hidden rounded-xl border border-slate-700/80 bg-slate-900/95 text-white shadow-2xl backdrop-blur"
  >
    <header class="relative flex users-center justify-between gap-4 px-4 py-2">
      <div class="flex users-center gap-4 min-w-0">
        <div
          class="w-8 h-8 rounded-lg bg-slate-800/70 border border-slate-700 flex users-center justify-center items-center flex-shrink-0"
        >
          <lucide-icon [img]="Inbox" class="w-4 h-4 text-slate-100" />
        </div>

        <div class="min-w-0">
          <h2 class="font-semibold leading-tight">Inbox</h2>
          <div class="text-xs text-slate-400">
            @if (friendRequestUsers.length === 0) {
              No pending friend requests
            } @else {
              Friend requests
            }
          </div>
        </div>
      </div>

      <div class="flex justify-center items-center">
        <div
          class="absolute top-full right-0 mt-2 px-2 py-1 bg-black/90 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap border border-white/10"
        >
          Pending friend requests
        </div>
      </div>
    </header>

    <div class="h-px bg-slate-700/60"></div>

    <section class="max-h-[60vh] overflow-auto">
      <div class="p-2">
        @for (user of friendRequestUsers; track user.id) {
          <div
            class="flex justify-between gap-4 rounded-lg px-4 py-2 hover:bg-slate-800/60 transition-colors"
          >
            <div class="flex gap-4 min-w-0">
              <div class="relative flex-shrink-0">
                <app-profile-image [src]="user.img" [status]="user.status" />
              </div>

              <div class="min-w-0">
                <div class="text-sm font-semibold truncate" [title]="user.username">
                  {{ user?.username ?? user.id }}
                </div>
                <div class="text-xs text-slate-400 truncate">
                  {{ user.email }}
                </div>
              </div>
            </div>

            <div class="flex justify-center gap-2">
              <button
                type="button"
                (click)="accept(user.id)"
                class="w-8 h-8 rounded-md bg-emerald-500/15 border border-emerald-400/20 hover:bg-emerald-500/25 transition-colors flex users-center justify-center items-center"
                title="Accept"
              >
                <lucide-icon [img]="Check" class="w-4 h-4 text-emerald-200" />
              </button>

              <button
                type="button"
                (click)="deny(user.id)"
                class="w-8 h-8 rounded-md bg-red-500/15 border border-red-400/20 hover:bg-red-500/25 transition-colors flex users-center justify-center items-center"
                title="Deny"
              >
                <lucide-icon [img]="X" class="w-4 h-4 text-red-200" />
              </button>
            </div>
          </div>
        } @empty {
          <div class="px-4 py-8 text-center">
            <div class="text-slate-200 font-medium">All caught up</div>
            <div class="text-sm text-slate-400 mt-1">New friend requests will show up here.</div>
          </div>
        }
      </div>
    </section>
  </div>
</div>
